<!doctype html><html lang=zh-tw>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> JOISC 2021 Day 2 | Little Cube Blog</title>
<meta name=description content="å¦‚æœæˆ‘ä¹Ÿèƒ½æˆç‚ºé›»ç¥å°±å¥½äº†...">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta name=google-site-verification content="OQ_9U47lnsbNF2bY2B6jTk8Ea7wqE_fu7ou8CAMe388">
<script src=https://code.iconify.design/1/1.0.7/iconify.min.js></script>
<script src=https://twemoji.maxcdn.com/v/latest/twemoji.min.js crossorigin=anonymous></script>
<script>window.onload=function(){twemoji.parse(document.body,{folder:'svg',ext:'.svg'})}</script>
<script src=https://littlecube8152.github.io/js/prism.js></script> <script src=https://littlecube8152.github.io/js/prism-line-numbers.js></script>
<meta property="og:title" content="JOISC 2021 Day 2">
<meta property="og:description" content="ç¬¨æ–¹å¡Šè€ç¬¨å¯« JOISC è¢«çˆ†æï¼Œç‡’é›">
<meta property="og:type" content="article">
<meta property="og:url" content="https://littlecube8152.github.io/posts/joisc-2021-escape-route/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2023-03-12T00:00:00+08:00">
<meta property="article:modified_time" content="2023-03-12T00:00:00+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="JOISC 2021 Day 2">
<meta name=twitter:description content="Escape Route">
<link rel=stylesheet href=https://littlecube8152.github.io/css/style-dark.css>
<link rel=stylesheet href=https://littlecube8152.github.io/css/prism.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://littlecube8152.github.io/images/favicon.ico>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQGDNSYSX"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-ZPQGDNSYSX')</script>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=../../>Home</a></li>
<li><a href=../../posts>Posts</a></li>
<li><a href=../../working>Working</a></li>
<li><a href=../../tags>Tags</a></li>
<li><a href=../../resources>Resources</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://littlecube8152.github.io/ aria-label=Home>
<i class="fas fa-home" aria-hidden=true onmouseover="$('#i-home').toggle()" onmouseout="$('#i-home').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=https://littlecube8152.github.io/posts/nhspc-2022-final/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-home class=info style=display:none>Home</span>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&text=JOISC%202021%20Day%202" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&is_video=false&description=JOISC%202021%20Day%202" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=JOISC%202021%20Day%202&body=Check out this article: https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&name=JOISC%202021%20Day%202&description=Escape%20Route" aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&t=JOISC%202021%20Day%202" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#é¡Œæ•˜>é¡Œæ•˜</a></li>
<li><a href=#é¡Œè§£>é¡Œè§£</a>
<ul>
<li><a href=#mathcal-on5>$\mathcal O(N^5)$</a></li>
<li><a href=#mathcal-on4>$\mathcal O(N^4)$</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
JOISC 2021 Day 2
</h1>
<h1 class=postsubtitle itemprop="name headline">
Escape Route
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2023-03-12 00:00:00 +0800 +0800" itemprop=datePublished>2023-03-12</time>
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=../../%20tags/joisc rel=tag>JOISC</a>
,
<a class=tag-link href=../../%20tags/oi rel=tag>OI</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<style type=text/css>#TableOfContents>ul>li:nth-child(2)>ul{display:none}</style>
<p>å¯èƒ½æ˜¯å› ç‚ºæˆ‘ä¸æœƒæ—¥æ–‡ï¼Œä½†æˆ‘é‚„æ˜¯è¦ºå¾—é€™é¡Œå¾ˆé…·æ‰€ä»¥æƒ³å¯«ä¸€ä¸‹æˆ‘æ€éº¼åšçš„ã€‚</p>
<h2 id=é¡Œæ•˜>é¡Œæ•˜</h2>
<p><a href=https://oj.uz/problem/view/JOI21_escape_route>Link</a></p>
<p>æœ‰ä¸€å¼µ $N$ é» $M$ é‚Šç„¡å‘åœ–ï¼Œæ¯å¤©çš„é•·åº¦æ˜¯ $S$ï¼Œ<br>
ç¬¬ $i$ æ¢é‚Šé€£æ¥ $A_i,\,B_i$ï¼Œåœ¨é‚£ä¸€å¤©çš„æ™‚é–“é»å°æ–¼ç­‰æ–¼ $L_i$ çš„æ™‚å€™å¯ä»¥è¡Œèµ°ï¼Œè²»æ™‚ $C_i$ï¼ˆä¹Ÿå°±æ˜¯è¦åœ¨æ™‚é–“é» $L_i - C_i$ ç•¶ä¸‹æˆ–ä¹‹å‰å‡ºç™¼æ‰æœ‰æ–™ï¼‰ï¼Œ<br>
æœ‰ $Q$ ç­†è©¢å•ï¼Œç¬¬ $j$ ç­†æƒ³è©¢å•å¾ç¬¬ 1 å¤©çš„æ™‚é–“é» $T_j$ é–‹å§‹ï¼Œå¾ $U_i$ èµ°åˆ° $V_i$ éœ€è¦å¤šä¹…ã€‚<br>
$2 \leq N \leq 90,\,M \leq \frac{N(N-1)}{2},\,2 \leq S \leq 10^{15},\,1 \leq L_i \leq C_i &lt; S,\,1 \leq Q \leq 3 \times 10^6,\,0 \leq T_j &lt; S$<br>
åœ–æ˜¯é€£é€šã€æ²’æœ‰è‡ªç’°ä¹Ÿæ²’æœ‰é‡é‚Šçš„ï¼ˆä¸è€ƒæ…® $L_i,\,C_i$ï¼‰ã€‚</p>
<p></br></br></br></br></br></br></p>
<h2 id=é¡Œè§£>é¡Œè§£</h2>
<p>è®“æˆ‘å€‘ä¾†è§€å¯Ÿä¸€ä¸‹ï¼Œå…ˆæŠŠ $S$ é€™å€‹å•é¡Œå¾ˆå¤§çš„äººè™•ç†æ‰ï¼Œå¦‚æœæˆ‘å€‘å…ˆå»è€ƒæ…®ç¬¬ä¸€å¤©å¯ä»¥èµ°å¤šé ï¼Œé‚£ç¬¬äºŒå¤©ä¹‹å¾Œå°±åªè¦å°æ¯å€‹æ ¹è·‘ä¸€æ¬¡ Dijkstra å°±èƒ½åšå®Œï¼Œæ¯æ¬¡ Query æ˜¯ $\mathcal O(QN)$ã€‚</p>
<h3 id=mathcal-on5>$\mathcal O(N^5)$</h3>
<h4 id=observation>Observation</h4>
<blockquote>
<p>å¯¦éš›ä¸Šï¼Œå°ä¸€å€‹é» $u$ ç•¶æ ¹ï¼Œè€ƒæ…®ç¬¬ä¸€å¤©ä»¥å…§çš„æ™‚é–“é» $t$ é–‹å§‹ï¼Œå¾ $u$ å¾€ä¸‹èµ°åˆ°æ‰€æœ‰ç¯€é» $v$ çš„æ™‚é–“ï¼Œ<br>
ç´€éŒ„ $d_t(u,\,v)$ æ˜¯ $u,\,v$ å…©é»åœ¨æ™‚é–“é» $t$ ä»¥å…§çš„è·é›¢ï¼Œ<br>
åªæœƒæœ‰ $\mathcal O(M) = \mathcal O(N^2)$ ç¨®ä¸ä¸€æ¨£çš„ $d_t$ã€‚</p>
</blockquote>
<p>æŠŠæ™‚é–“é» $t$ è¨­æˆ $0$ é–‹å§‹è·‘ Dijkstra å¯ä»¥å¾—åˆ°ç•¶ä¸‹å¾ $u$ å‡ºç™¼èµ°åˆ°æ‰€æœ‰ç¯€é» $v$ çš„æ™‚é–“ï¼Œè€ƒæ…®é€™å€‹æœ€çŸ­è·¯æ¨¹ï¼Œä¸€å®šå­˜åœ¨å¦ä¸€å€‹ $t'$ è®“æ™‚é–“åœ¨ $t'$ ä¹‹å¾Œæœ‰ä¸€æ¢é‚Šä¸èƒ½èµ°ï¼Œ<br>
åœ¨ $[t,\, t')$ çš„æ™‚é–“åº•ä¸‹ï¼Œç¾åœ¨çš„é€™æ£µæœ€çŸ­è·¯æ¨¹ä¸€å®šæ˜¯æœ€å„ªçš„ï¼Œæ‰€ä»¥æˆ‘å€‘åªè¦åœ¨ $t'$ ä¹‹å¾Œé‡è“‹ä¸€æ£µï¼Œ<br>
é€™ç¨®åˆ‡æ›çš„æ™‚é–“é»æœ€å¤šåªæœ‰ $M$ å€‹ï¼Œå› ç‚ºæ¯æ¬¡é‚Šéƒ½æœƒå°‘ä¸€æ¢ï¼Œ<br>
ï¼ˆæ³¨æ„æœ‰å¯èƒ½æœ‰ä¸€å€‹æ™‚é–“é»çªç„¶æ‹”æ‰å¾ˆå¤šæ¢ï¼‰<br>
æ‰€ä»¥ç›´æ¥è“‹å‡ºæ¯å€‹æ ¹ $\mathcal O(N) \times \mathcal O(N^2)$ å€‹æ™‚é–“é» $\times$ æ¯æ¬¡ Dijkstra $\mathcal O(N^2)$ï¼Œ</p>
<h3 id=mathcal-on4>$\mathcal O(N^4)$</h3>
<p>è¦æ€éº¼åˆªé‚Šï¼Ÿ<br>
åˆªé‚Šä¼¼ä¹è¶…é›£ï¼Œé‚£è€ƒæ…®å€’æµçš„å•é¡Œï¼šåŠ é‚Šï¼Ÿ<br>
å¥½åƒé‚„æ˜¯å¾ˆé›£ï¼Œé‚£æˆ‘å€‘ä¾†çœ‹çœ‹æˆ‘å€‘å¹³å¸¸æ˜¯æ€éº¼åŠ é‚Šçš„ï¼Œ</p>
<p>é¦–å…ˆç¬¬ä¸€å€‹æ€§è³ªæ˜¯ï¼ŒåŠ é‚Šçš„ç­”æ¡ˆåªæœƒæ›´å¥½ï¼Œæ‰€ä»¥åŸæœ¬é©ç”¨çš„é‚Šä¸æœƒå†è¢«æ‹”æ‰ã€‚</p>
<p>è€ƒæ…®æˆ‘å€‘å·²ç¶“æœ‰å…¨é»å°æœ€çŸ­è·¯ $d(u,\,v)$ï¼Œé‚£è¦åŠ å…¥ä¸€æ¢é‚Š $(x,\,y)$ æ¬Šé‡æ˜¯ $w$ï¼Œæˆ‘å€‘æœƒéœ€è¦åšé€™ä»¶äº‹ï¼š<br>
æšèˆ‰ $u,\,v$ï¼Œç„¶å¾Œæ›´æ–° $d(u,\,v) = \min(d(u,\,v), d(u,\,x) + w + d(y,\,v), d(u,\,y) + w + d(x,\,v))$ï¼Œ<br>
ç‚ºäº†æ–¹ä¾¿æŠŠå³åƒåœ–è½‰æ›æˆæœ‰å‘ï¼Œå¼å­ç°¡åŒ–æˆåªè¦è¨ˆç®—ä¸€é‚Š $d(u,\,v) = \min(d(u,\,v), d(u,\,x) + w + d(y,\,v))$ï¼Œ<br>
å¯ä»¥è§€å¯Ÿæ›´æ–°çš„é †åºä¸å½±éŸ¿çµæœï¼Œå› ç‚ºæœ€çŸ­è·¯å‹¢å¿…æ˜¯ç°¡å–®è·¯å¾‘ï¼ˆé€™è£¡å‡è¨­é‚Šæ¬Šç‚ºæ­£ï¼Œäº‹å¯¦ä¸Šè¦æ˜¯éè² ï¼Œé‚£ä¹Ÿæœƒå­˜åœ¨ä¸€æ¢æ˜¯ç°¡å–®è·¯ï¼‰ã€‚</p>
<p>ç”¨é€™å€‹æƒ³æ³•ï¼Œè®“æ™‚å…‰å€’æµï¼Œè¨ˆç®—æ–°çš„ $t$ çš„æ™‚å€™ï¼ŒæœƒåŠ å…¥è‡³å°‘ä¸€æ¢é‚Šï¼Œ<br>
åŠ å…¥ä¸€æ¢é‚Š $(x,\,y)$ çš„æ™‚å€™ï¼Œå¯ä»¥å¯«æˆ $d_t(u,\,v) = \min(d_t(u,\,v), d_t(u,\,x) + w + d_{t+d_t(u,\,v), d_t(u,\,x)}(y,\,v))$ï¼Œ<br>
è€ƒæ…®èµ·é»æ˜¯å›ºå®šçš„ï¼Œé‚£å¾èµ·é»èµ°åˆ° $y$ çš„ï¼ˆä¹Ÿå°±æ˜¯å‰å…©é …ï¼‰æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”é€™å€‹æ™‚é–“é»æ˜¯åœ¨æˆ‘å€‘ç¾åœ¨è¦ç®—çš„ $t$ ä¹‹å¾Œï¼Œè®“ $t+d_t(u,\,v), d_t(u,\,x)$ æ˜¯ $t'$ï¼Œ<br>
é‚£ä½œæ³•å°±å¾ˆæ˜é¡¯äº†ï¼Œæˆ‘å€‘æŠŠé€™äº›æ›´æ–°é€šé€šä¸Ÿé€² priority_queue è£¡é¢ï¼Œæ¯æ¬¡æ‹¿æ™‚é–“æœ€å¤§çš„æ›´æ–°å»åšï¼Œ<br>
å¦‚æœç¾åœ¨æ™‚é–“é»æœ€å¤§çš„æ›´æ–°ç™¼ç”Ÿåœ¨ $t'$ï¼Œæˆ‘å€‘æƒ³èªªæ˜ç•¶ä¸‹ä¸å¯èƒ½æœ‰å…¶ä»–æ›´æ–°æœƒè®“ $y$ å¾€ä¸‹èµ°çš„æ™‚é–“æ›´å¥½ã€‚<br>
å‡è¨­ç¢ºå¯¦å­˜åœ¨å¦ä¸€å€‹æ›´æ–°ç™¼ç”Ÿåœ¨åŠ å…¥åœ–ä¸­æœƒç”¢ç”Ÿå¦ä¸€å€‹æ›´æ–°ç™¼ç”Ÿåœ¨æ¯” $t'$ æ›´å¤§çš„æ™‚é–“é»ï¼Œé€™å…©å€‹æ›´æ–°ä¸€å®šéƒ½æ˜¯ç™¼ç”Ÿåœ¨ä»¥ $y$ ç‚ºæ ¹çš„åœ–ä¸Šï¼Œ<br>
é‚£å¯¦éš›ä¸Šé€™å€‹æ›´æ–°è‡³å°‘è¦åˆ° $T$ æ‰æœƒç™¼æ®ä½œç”¨ï¼Œå› ç‚ºæ²’æœ‰åŠ å…¥é€™æ¢é‚Šå°±ä¸å¯èƒ½æœƒå½±éŸ¿å¾Œé¢çš„æ‰€æœ‰æ›´æ–°ï¼Œ<br>
å› æ­¤ï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç•¶æŠŠæ™‚é–“æœ€å¤§çš„æ›´æ–°æ‹¿å»åšçš„æ™‚å€™ï¼Œæˆ‘å€‘æƒ³çŸ¥é“æ™‚é–“é»åœ¨ $t'$ ä»¥å¾Œçš„æ‰€æœ‰é»çš„ç­”æ¡ˆå…¶å¯¦éƒ½å·²ç¶“å›ºå®šä¸‹ä¾†äº†ï¼Œ<br>
æ‰€ä»¥æˆ‘å€‘åªéœ€è¦ä¸€é‚Šè“‹ä¸€é‚Šè©¢å•ï¼Œæ¯æ¬¡æ›´æ–°å¾ Dijkstra $\mathcal O(N^2)$ è®Šç‚º $\mathcal O(N)$ï¼Œ<br>
ç¸½å…±æ›´æ–°çš„æ•¸é‡ä¹Ÿç¶­æŒä¸è®Šæ˜¯ $\mathcal O(N^3)$ï¼Œåœ¨ pq è£¡é¢åªæœƒå¤šä¸€å€‹ $\log$ï¼Œ<br>
ç¸½æ™‚é–“è¤‡é›œåº¦ä¾†åˆ° $\mathcal O(N^4)$ï¼ŒåŠ ä¸Šå‰é¢çš„æŸ¥è©¢ $\mathcal O(QN)$ è¶³ä»¥é€šéã€‚</p>
<p>å…¶å¯¦é€™é¡Œæ˜æ˜æƒ³æ³•ä¸é›£ä½†ç‚ºå•¥æˆªè‡³ç¾åœ¨åªæœ‰ 11 å€‹äººå¯« <emoji>ğŸ¤”</emoji></p>
<details>
<summary> Code </summary>
<pre><code class=language-cpp>#include &quot;escape_route.h&quot;
#include &lt;bits/stdc++.h&gt;
#define pii pair&lt;int, int&gt;
#define pll pair&lt;ll, ll&gt;
#define F first
#define S second
#define ll long long
using namespace std;

const ll inf = 100'000'000'000'000'000;
ll d1[90][90 * 90 + 5][90], d2[90][90], from[90];
vector&lt;ll&gt; tp[90];
vector&lt;pll&gt; last[90][90];

int getT(int i, ll t)
{
    return upper_bound(tp[i].begin(), tp[i].end(), t, greater&lt;&gt;()) - tp[i].begin() - 1;
}

void update(int N, int r, int t, int u, int v, ll w)
{
    int vt = getT(v, d1[r][t][u] + w);
    if (vt &lt; 0)
        return;
    for (int i = 0; i &lt; N; i++)
        d1[r][t][i] = min(d1[r][t][u] + w + d1[v][vt][i] - tp[v][vt], d1[r][t][i]);
}

pll calcNextEdge(int N, int r, ll T, int t)
{
    ll nt = -1, ni = -1, nj = -1;
    for (int i = 0; i &lt; N; i++)
        if (!last[r][i].empty())
            if (nt &lt; T - (d1[r][t][i] - last[r][i].back().F))
                nt = T - (d1[r][t][i] - last[r][i].back().F), ni = i;

    if (ni &gt;= 0)
    {
        nj = last[r][ni].back().S;
        last[r][ni].pop_back();
    }
    return pll(nj, nt);
}

vector&lt;ll&gt; calculate_necessary_time(
    int N, int M, ll S, int Q,
    vector&lt;int&gt; A, vector&lt;int&gt; B, vector&lt;ll&gt; L, vector&lt;ll&gt; C, vector&lt;int&gt; U, vector&lt;int&gt; V, vector&lt;ll&gt; T)
{
    for (int i = 0; i &lt; N; i++)
    {
        for (int j = 0; j &lt; M; j++)
        {
            last[i][A[j]].emplace_back(pll(C[j] - L[j], j));
            last[i][B[j]].emplace_back(pll(C[j] - L[j], j));
        }
        for (int j = 0; j &lt; N; j++)
            sort(last[i][j].begin(), last[i][j].end());
    }

    priority_queue&lt;tuple&lt;ll, int, int&gt;&gt; pq;
    for (int i = 0; i &lt; N; i++)
    {
        tp[i].emplace_back(S - 1);
        for (int j = 0; j &lt; N; j++)
            d1[i][0][j] = (i == j ? S - 1 : inf &lt;&lt; 1);
        auto [j, nt] = calcNextEdge(N, i, tp[i].back(), (int)tp[i].size() - 1);
        if (nt &gt;= 0)
            pq.push(make_tuple(nt, i, j));
    }

    while (!pq.empty())
    {
        auto [t, i, j] = pq.top();
        pq.pop();
        if (t &lt; tp[i].back())
        {
            tp[i].emplace_back(t);
            int tt = (int)tp[i].size() - 1;
            for (int k = 0; k &lt; N; k++)
                d1[i][tt][k] = d1[i][tt - 1][k] - (tp[i][tt - 1] - tp[i][tt]);
        }
        update(N, i, (int)tp[i].size() - 1, A[j], B[j], L[j]);
        update(N, i, (int)tp[i].size() - 1, B[j], A[j], L[j]);
        auto [k, nt] = calcNextEdge(N, i, tp[i].back(), (int)tp[i].size() - 1);
        if (nt &gt;= 0)
            pq.push(make_tuple(nt, i, k));
    }
    
    vector&lt;pair&lt;int, pll&gt;&gt; E[90];
    for (int i = 0; i &lt; M; i++)
    {
        E[A[i]].emplace_back(make_pair(B[i], pll(C[i], L[i])));
        E[B[i]].emplace_back(make_pair(A[i], pll(C[i], L[i])));
    }
    for (int i = 0; i &lt; N; i++)
    {
        for (int j = 0; j &lt; N; j++)
            d2[i][j] = (i == j ? 0 : inf);
        priority_queue&lt;pll, vector&lt;pll&gt;, greater&lt;pll&gt;&gt; pq;
        pq.push(pll(0, i));
        while (!pq.empty())
        {
            auto [d, u] = pq.top();
            pq.pop();
            if (d &gt; d2[i][u])
                continue;
            for (auto [v, p] : E[u])
            {
                auto [c, l] = p;
                ll nd = (d % S &lt;= c - l ? d : (d + S - 1) / S * S) + l;
                if (nd &lt; d2[i][v])
                {
                    d2[i][v] = nd;
                    pq.push(pll(d2[i][v], v));
                }
            }
        }
    }

    vector&lt;ll&gt; ans(Q);
    for (int i = 0; i &lt; Q; i++)
    {
        int t = upper_bound(tp[U[i]].begin(), tp[U[i]].end(), T[i], greater&lt;&gt;()) - tp[U[i]].begin() - 1;
        ans[i] = inf;
        for (int j = 0; j &lt; N; j++)
            if (d1[U[i]][t][j] &lt; inf)
            {
                if (j == V[i])
                    ans[i] = min(ans[i], d1[U[i]][t][j] - tp[U[i]][t]);
                else
                    ans[i] = min(ans[i], S + d2[j][V[i]] - T[i]);
            }
    }
    return ans;
}
</code></pre>
</details>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=../../>Home</a></li>
<li><a href=../../posts>Posts</a></li>
<li><a href=../../working>Working</a></li>
<li><a href=../../tags>Tags</a></li>
<li><a href=../../resources>Resources</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li><a href=#é¡Œæ•˜>é¡Œæ•˜</a></li>
<li><a href=#é¡Œè§£>é¡Œè§£</a>
<ul>
<li><a href=#mathcal-on5>$\mathcal O(N^5)$</a></li>
<li><a href=#mathcal-on4>$\mathcal O(N^4)$</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&text=JOISC%202021%20Day%202" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&is_video=false&description=JOISC%202021%20Day%202" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=JOISC%202021%20Day%202&body=Check out this article: https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&title=JOISC%202021%20Day%202" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&name=JOISC%202021%20Day%202&description=Escape%20Route" aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2flittlecube8152.github.io%2fposts%2fjoisc-2021-escape-route%2f&t=JOISC%202021%20Day%202" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2023 Little Cube Blog
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=../../>Home</a></li>
<li><a href=../../posts>Posts</a></li>
<li><a href=../../working>Working</a></li>
<li><a href=../../tags>Tags</a></li>
<li><a href=../../resources>Resources</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=../../lib/font-awesome/css/all.min.css>
<script src=../../lib/jquery/jquery.min.js></script>
<script src=../../js/main.js></script>
<script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}}</script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script>
</script>
</html>